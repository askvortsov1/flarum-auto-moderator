{"version":3,"sources":["webpack://@askvortsov/flarum-auto-moderator/webpack/bootstrap","webpack://@askvortsov/flarum-auto-moderator/./admin.js","webpack://@askvortsov/flarum-auto-moderator/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@askvortsov/flarum-auto-moderator/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@askvortsov/flarum-auto-moderator/./src/admin/components/AutoModeratorPage.js","webpack://@askvortsov/flarum-auto-moderator/./src/admin/components/CriterionPage.js","webpack://@askvortsov/flarum-auto-moderator/./src/admin/components/GroupActionDriverSettings.js","webpack://@askvortsov/flarum-auto-moderator/./src/admin/components/GroupSelector.js","webpack://@askvortsov/flarum-auto-moderator/./src/admin/components/MinMaxSelector.js","webpack://@askvortsov/flarum-auto-moderator/./src/admin/index.js","webpack://@askvortsov/flarum-auto-moderator/./src/common/augmentEditUserModal.js","webpack://@askvortsov/flarum-auto-moderator/./src/common/models/Criterion.js","webpack://@askvortsov/flarum-auto-moderator/./src/common/registerModels.js","webpack://@askvortsov/flarum-auto-moderator/./src/common/utils/managedGroups.js","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['Component']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['Model']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['admin/components/AdminPage']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['admin/components/ExtensionPage']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/components/Alert']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/components/Button']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/components/EditUserModal']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/components/GroupBadge']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/components/Link']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/components/LinkButton']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/components/Select']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/components/Tooltip']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/extend']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/helpers/icon']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/utils/ItemList']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/utils/Stream']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/utils/classList']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['common/utils/stringToColor']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['components/Button']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['components/Dropdown']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['helpers/icon']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['models/Group']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['models/User']\"","webpack://@askvortsov/flarum-auto-moderator/external \"flarum.core.compat['utils/Stream']\""],"names":["criterionItem","criterion","name","app","translator","trans","iconName","style","stringToColor","color","route","icon","classList","isValid","AutoModeratorPage","oninit","vnode","loading","store","find","then","m","redraw","content","all","map","ExtensionPage","actionDefs","metricDefs","requirementDefs","metricItem","metric","selected","metricDef","type","missingExt","translationKey","Button","component","className","onclick","filter","val","min","max","requirementItem","requirement","actionItem","action","actionDef","forms","actionDriverSettingsComponents","settings","Object","keys","availableSettings","s","e","target","value","CriterionPage","id","param","Stream","description","actionsOnGain","actionsOnLoss","metrics","requirements","newMetric","newActionOnGain","newActionOnLoss","loadingDrivers","request","method","url","forum","attribute","response","loadingCriterion","actions","a","gain","headerInfo","title","onsubmit","bind","errors","metricsAndRequirementsForm","actionsForm","saving","deleting","push","validation","invalidActionSettings","length","key","join","Select","options","reduce","acc","onchange","disabled","data","preventDefault","set","createRecord","save","AdminPage","GroupActionDriverSettings","view","attrs","group_id","Component","GroupSelector","group","getById","label","namePlural","g","Group","MEMBER_ID","GUEST_ID","includes","active","MinMaxSelector","state","controls","minInput","State","BETWEEN","Infinity","maxInput","Math","placeholder","button","cycle","LTE","GTE","initializers","add","routes","path","add_to_group","remove_from_group","extensionData","registerPage","augmentEditUserModal","registerModels","extend","EditUserModal","prototype","criteria","managedGroups","forEach","groups","override","original","items","ItemList","user","badge","GroupBadge","groupName","Criterion","nameSingular","Model","models","User","hasMany","ids","groupId"],"mappings":"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","file":"admin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./admin.js\");\n","export * from './src/admin';\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import ExtensionPage from \"flarum/admin/components/ExtensionPage\";\nimport Link from \"flarum/common/components/Link\";\nimport LoadingIndicator from \"flarum/common/components/LoadingIndicator\";\nimport Tooltip from \"flarum/common/components/Tooltip\";\nimport icon from \"flarum/common/helpers/icon\";\nimport classList from \"flarum/common/utils/classList\";\nimport stringToColor from \"flarum/common/utils/stringToColor\";\n\nfunction criterionItem(criterion) {\n  const name = criterion\n    ? criterion.name()\n    : app.translator.trans(\n        \"askvortsov-auto-moderator.admin.automoderator_page.create_criterion_button\"\n      );\n  const iconName = criterion ? 'fas fa-bolt' : \"fas fa-plus\";\n  const style = criterion\n    ? { \"background-color\": stringToColor(criterion.name()), color: \"white\" }\n    : \"\";\n  return (\n    <Link\n      className=\"ExtensionListItem\"\n      href={app.route.criterion(criterion)}\n    >\n      <span className=\"ExtensionListItem-icon ExtensionIcon\" style={style}>\n        {icon(iconName)}\n      </span>\n      <span className={classList({ 'ExtensionListItem-title': true, 'ExtensionListItem--invalid': criterion && !criterion.isValid()})}>\n        {criterion && !criterion.isValid() && <Tooltip text={app.translator.trans('askvortsov-auto-moderator.admin.automoderator_page.criterion_invalid')}>\n          {icon('fas fa-exclamation-triangle')}\n        </Tooltip>}\n        {name}\n      </span>\n    </Link>\n  );\n}\n\nexport default class AutoModeratorPage extends ExtensionPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.loading = true;\n\n    app.store.find(\"criteria\").then(() => {\n      this.loading = false;\n      m.redraw();\n    });\n  }\n  content() {\n    if (this.loading) {\n      return (\n        <div className=\"Criteria\">\n          <div className=\"container\">\n            <LoadingIndicator />\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"Criteria\">\n        <div className=\"container\">\n          <div className=\"ExtensionsWidget-list Criteria-list\">\n            <p className=\"Criteria-list-heading\">\n              {app.translator.trans(\n                \"askvortsov-auto-moderator.admin.automoderator_page.list_heading\"\n              )}\n            </p>\n            <div className=\"ExtensionList\">\n              {[\n                ...app.store.all(\"criteria\").map(criterionItem),\n                criterionItem(),\n              ]}\n            </div>\n          </div>\n          <div className=\"Criteria-footer\">\n            <p>\n              {app.translator.trans(\n                \"askvortsov-auto-moderator.admin.automoderator_page.instructions_header\"\n              )}\n            </p>\n            <ul>\n              {app.translator.trans(\n                \"askvortsov-auto-moderator.admin.automoderator_page.instructions_text\"\n              )}\n            </ul>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import AdminPage from \"flarum/admin/components/AdminPage\";\nimport Alert from \"flarum/common/components/Alert\";\nimport Button from \"flarum/common/components/Button\";\nimport LinkButton from \"flarum/common/components/LinkButton\";\nimport Select from \"flarum/common/components/Select\";\nimport Tooltip from \"flarum/common/components/Tooltip\";\nimport LoadingIndicator from \"flarum/common/components/LoadingIndicator\";\nimport icon from \"flarum/common/helpers/icon\";\nimport classList from \"flarum/common/utils/classList\";\nimport Stream from \"flarum/common/utils/Stream\";\n\nimport MinMaxSelector from './MinMaxSelector';\n\nlet actionDefs;\nlet metricDefs;\nlet requirementDefs;\n\nfunction metricItem(metric, selected) {\n    const metricDef = metricDefs[metric.type];\n\n    return (\n        <li>\n            <div className={classList({ 'DriverListItem-info': true, 'DriverListItem--missingExt': metricDef.missingExt })}>\n                {metricDef.missingExt && <Tooltip text={app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.driver_missing_ext')}>\n                    {icon('fas fa-exclamation-triangle')}\n                </Tooltip>}\n                <span className=\"DriverListItem-name\">{app.translator.trans(metricDef.translationKey)}</span>\n                {Button.component({\n                    className: 'Button Button--link',\n                    icon: 'fas fa-trash-alt',\n                    onclick: () => selected(selected().filter(val => val !== metric))\n                })}\n            </div>\n            <MinMaxSelector\n                min={metric.min}\n                max={metric.max}\n            ></MinMaxSelector>\n            <hr />\n        </li>\n    );\n}\n\nfunction requirementItem(requirement) {\n\n}\n\nfunction actionItem(action, selected) {\n    const actionDef = actionDefs[action.type];\n\n    const forms = app['askvortsov-auto-moderator'].actionDriverSettingsComponents;\n\n    let settings;\n    if (action.type in forms) {\n        settings = forms[action.type].component({ action, actionDef });\n    } else {\n        settings = (\n            Object.keys(actionDef.availableSettings).map(s => (\n                <div className=\"Form-group\">\n                    <input\n                        className=\"FormControl\"\n                        value={action.settings[s]}\n                        onchange={e => action.settings[s] = e.target.value}\n                        placeholder={app.translator.trans(actionDef.availableSettings[s])}\n                    />\n                </div>\n            ))\n        );\n    }\n\n    return (\n        <li>\n            <div className={classList({ 'DriverListItem-info': true, 'DriverListItem--missingExt': actionDef.missingExt })}>\n                {actionDef.missingExt && <Tooltip text={app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.driver_missing_ext')}>\n                    {icon('fas fa-exclamation-triangle')}\n                </Tooltip>}\n                <span className=\"DriverListItem-name\">{app.translator.trans(actionDef.translationKey)}</span>\n                {Button.component({\n                    className: 'Button Button--link',\n                    icon: 'fas fa-trash-alt',\n                    onclick: () => selected(selected().filter(val => val !== action))\n                })}\n                <div className=\"DriverListItem-form\">\n                    {settings}\n                </div>\n            </div>\n            <hr />\n        </li>\n    );\n}\n\n\n\nexport default class CriterionPage extends AdminPage {\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.id = m.route.param('id');\n\n        this.name = Stream('');\n        this.description = Stream('');\n        this.actionsOnGain = Stream([]);\n        this.actionsOnLoss = Stream([]);\n        this.metrics = Stream([]);\n        this.requirements = Stream([]);\n\n        this.newMetric = Stream('');\n        this.newActionOnGain = Stream('');\n        this.newActionOnLoss = Stream('');\n\n        this.loadingDrivers = true;\n\n        app\n            .request({\n                method: 'GET',\n                url: app.forum.attribute('apiUrl') + '/automod_drivers',\n            })\n            .then((response) => {\n                actionDefs = response['data']['attributes']['action'];\n                metricDefs = response['data']['attributes']['metric'];\n\n                this.loadingDrivers = false;\n                m.redraw();\n            });\n\n\n        if (this.id === 'new') return;\n\n        this.loadingCriterion = true;\n\n        app.store\n            .find('criteria', this.id)\n            .then(criterion => {\n                this.criterion = criterion;\n                this.name(criterion.name());\n                this.description(criterion.description());\n                this.metrics(criterion.metrics().map(m => { return { type: m.type, min: Stream(m.min), max: Stream(m.max) } }))\n                this.actionsOnGain(criterion.actions().filter(a => a.gain));\n                this.actionsOnLoss(criterion.actions().filter(a => !a.gain));\n                this.requirements(criterion.requirements());\n\n                this.loadingCriterion = false;\n                m.redraw();\n            });\n    }\n\n    headerInfo() {\n        let title;\n        let description = '';\n\n        if (this.loadingCriterion) {\n            description = app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.loading');\n            title = app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.loading');\n        } else if (this.criterion) {\n            title = this.criterion.name();\n        } else {\n            title = app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.new_criterion');\n        }\n\n        return {\n            className: 'CriterionPage',\n            icon: 'fas fa-bolt',\n            title,\n            description,\n        };\n    }\n\n    content() {\n        if (this.loadingCriterion || this.loadingDrivers) {\n            return (\n                <div className=\"Criteria\">\n                    <div className=\"container\">\n                        <LoadingIndicator />\n                    </div>\n                </div>\n            );\n        }\n\n        return (\n            <div className=\"Criteria\">\n                <div className=\"container\">\n                    <form onsubmit={this.onsubmit.bind(this)}>\n                        <div className=\"Form-group\">\n                            <LinkButton className=\"Button\" icon=\"fas fa-chevron-left\" href={app.route('extension', { id: 'askvortsov-auto-moderator' })}>\n                                {app.translator.trans(\n                                    \"askvortsov-auto-moderator.admin.criterion_page.back\"\n                                )}\n                            </LinkButton>\n                        </div>\n                        <div className=\"Form-group\">\n                            {this.errors()}\n                        </div>\n                        <div className=\"Form-group\">\n                            <label>\n                                {app.translator.trans(\n                                    \"askvortsov-auto-moderator.admin.criterion_page.name_label\"\n                                )}\n                            </label>\n                            <input\n                                className=\"FormControl\"\n                                bidi={this.name}\n                                required={true}\n                            />\n                        </div>\n                        <div className=\"Form-group\">\n                            <label>\n                                {app.translator.trans(\n                                    \"askvortsov-auto-moderator.admin.criterion_page.description_label\"\n                                )}\n                            </label>\n                            <input\n                                className=\"FormControl\"\n                                bidi={this.description}\n                            />\n                        </div>\n                        {this.metricsAndRequirementsForm()}\n                        {this.actionsForm()}\n                        <div className=\"Form-group\">\n                            <Button type=\"submit\" className=\"Button Button--primary\" loading={this.saving} disabled={this.saving}>\n                                {app.translator.trans('core.admin.settings.submit_button')}\n                            </Button>\n                        </div>\n                        {this.criterion &&\n                            <Button type=\"button\" onclick={this.delete.bind(this)} className=\"Button Button--danger\" loading={this.deleting} disabled={this.saving}>\n                                {app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.delete_button')}\n                            </Button>}\n                    </form>\n                </div>\n            </div>\n        );\n    }\n\n    errors() {\n        if (!this.criterion) return;\n        const errors = [];\n\n        if (!this.criterion.isValid()) {\n            errors.push(\n                <Alert type='error' dismissible={false}>\n                    {app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.invalid')}\n                </Alert>\n            );\n        }\n\n        const validation = this.criterion.invalidActionSettings();\n        if (validation && Object.keys(validation).length) {\n            errors.push(\n                <Alert type='error' dismissible={false}>\n                    {app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.validation')}\n                    <div><ol>{Object.keys(validation).map(key => <li><strong>{key}:</strong> {validation[key].join(\"\")}</li>)}</ol></div>\n                </Alert>\n            );\n        }\n\n        return <div className=\"StatusCheck\">{errors}</div>;\n    }\n\n    metricsAndRequirementsForm() {\n        return (\n            <div className=\"Form-group\">\n                <label>\n                    {app.translator.trans(\n                        \"askvortsov-auto-moderator.admin.criterion_page.metrics_and_requirements_label\"\n                    )}\n                </label>\n                <div className=\"helpText\">\n                    {app.translator.trans(\n                        \"askvortsov-auto-moderator.admin.criterion_page.metrics_and_requirements_help\"\n                    )}\n                </div>\n                <div className=\"SettingsGroups\">\n                    <div className=\"DriverGroup\">\n                        <label>{app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.metrics_heading')}</label>\n                        <ul className=\"DriverList DriverList--primary\">\n                            {this.metrics().map(m => metricItem(m, this.metrics))}\n                        </ul>\n                        <span class=\"DriverGroup-controls\">\n                            {Select.component({\n                                options: Object.keys(metricDefs)\n                                    .reduce(\n                                        (acc, key) => {\n                                            acc[key] = app.translator.trans(metricDefs[key].translationKey);\n                                            return acc;\n                                        }, {}\n                                    ),\n                                value: this.newMetric(),\n                                onchange: this.newMetric\n                            })}\n                            {Button.component(\n                                {\n                                    className: 'Button DriverList-button',\n                                    icon: 'fas fa-plus',\n                                    disabled: !this.newMetric(),\n                                    onclick: () => {\n                                        this.metrics([...this.metrics(), { type: this.newMetric(), min: Stream(), max: Stream() }])\n                                    }\n                                }\n                            )}\n                        </span>\n                    </div>\n\n                    {/* <div className=\"DriverGroup DriverGroup--secondary\">\n                        <label>{app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.requirements_heading')}</label>\n                        <ul className=\"DriverList\">\n                        </ul>\n                        {Button.component(\n                            {\n                                className: 'Button DriverList-button',\n                                icon: 'fas fa-plus',\n                            },\n                            app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.add_requirement')\n                        )}\n                    </div> */}\n                </div>\n            </div>\n        )\n    };\n\n    actionsForm() {\n        return (\n            <div className=\"Form-group\">\n                <label>\n                    {app.translator.trans(\n                        \"askvortsov-auto-moderator.admin.criterion_page.actions_label\"\n                    )}\n                </label>\n                <div className=\"helpText\">\n                    {app.translator.trans(\n                        \"askvortsov-auto-moderator.admin.criterion_page.actions_help\"\n                    )}\n                </div>\n                <div className=\"SettingsGroups\">\n                    <div className=\"DriverGroup\">\n                        <label>{app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.actions_on_gain_heading')}</label>\n                        <ul className=\"DriverList DriverList--primary\">\n                            {this.actionsOnGain().map(a => actionItem(a, this.actionsOnGain))}\n                        </ul>\n                        <span class=\"DriverGroup-controls\">\n                            {Select.component({\n                                options: Object.keys(actionDefs)\n                                    .reduce(\n                                        (acc, key) => {\n                                            acc[key] = app.translator.trans(actionDefs[key].translationKey);\n                                            return acc;\n                                        }, {}\n                                    ),\n                                value: this.newActionOnGain(),\n                                onchange: this.newActionOnGain\n                            })}\n                            {Button.component(\n                                {\n                                    className: 'Button DriverList-button',\n                                    icon: 'fas fa-plus',\n                                    disabled: !this.newActionOnGain(),\n                                    onclick: () => {\n                                        this.actionsOnGain([...this.actionsOnGain(), { type: this.newActionOnGain(), settings: {} }])\n                                    }\n                                }\n                            )}\n                        </span>\n                    </div>\n\n                    <div className=\"DriverGroup DriverGroup--secondary\">\n                        <label>{app.translator.trans('askvortsov-auto-moderator.admin.criterion_page.actions_on_loss_heading')}</label>\n                        <ul className=\"DriverList\">\n                            {this.actionsOnLoss().map(a => actionItem(a, this.actionsOnLoss))}\n                        </ul>\n                        <span class=\"DriverGroup-controls\">\n                            {Select.component({\n                                options: Object.keys(actionDefs)\n                                    .reduce(\n                                        (acc, key) => {\n                                            acc[key] = app.translator.trans(actionDefs[key].translationKey);\n                                            return acc;\n                                        }, {}\n                                    ),\n                                value: this.newActionOnLoss(),\n                                onchange: this.newActionOnLoss\n                            })}\n                            {Button.component(\n                                {\n                                    className: 'Button DriverList-button',\n                                    icon: 'fas fa-plus',\n                                    disabled: !this.newActionOnLoss(),\n                                    onclick: () => {\n                                        this.actionsOnLoss([...this.actionsOnLoss(), { type: this.newActionOnLoss(), settings: {} }])\n                                    }\n                                }\n                            )}\n                        </span>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n\n    data() {\n        return {\n            name: this.name(),\n            description: this.description(),\n            actions: [\n                ...this.actionsOnGain().map(a => { return { ...a, gain: true } }),\n                ...this.actionsOnLoss().map(a => { return { ...a, gain: false } })\n            ],\n            metrics: this.metrics().map(m => { return { type: m.type, min: m.min(), max: m.max() } }),\n            requirements: this.requirements()\n        }\n    }\n\n    delete(e) {\n        e.preventDefault();\n\n        this.deleting = true;\n        m.redraw();\n\n        this.criterion\n            .delete()\n            .then(() => {\n                m.route.set(app.route('extension', { id: 'askvortsov-auto-moderator' }))\n            });\n    }\n\n    onsubmit(e) {\n        e.preventDefault();\n\n        this.saving = true;\n        m.redraw();\n\n        const criterion = this.criterion || app.store.createRecord(\"criteria\");\n\n        criterion\n            .save(this.data())\n            .then(() => {\n                this.saving = false;\n                m.redraw();\n            });\n    }\n}\n","import Component from \"flarum/Component\";\nimport GroupSelector from './GroupSelector';\n\nexport default class GroupActionDriverSettings extends Component {\n    view() {\n        const action = this.attrs.action;\n\n        return (\n            <GroupSelector\n                value={action.settings.group_id}\n                onchange={(val) => action.settings = { group_id: val }}\n            ></GroupSelector>\n        );\n    }\n}","import Component from \"flarum/Component\";\nimport Button from \"flarum/components/Button\";\nimport Dropdown from \"flarum/components/Dropdown\";\nimport icon from \"flarum/helpers/icon\";\nimport Group from \"flarum/models/Group\";\n\nexport default class GroupSelector extends Component {\n  view() {\n    const group = app.store.getById(\"groups\", this.attrs.value);\n    const label = group\n      ? [icon(group.icon()), \"\\t\", group.namePlural()]\n      : app.translator.trans(\n          \"askvortsov-auto-moderator.admin.group_selector.placeholder\"\n        );\n    return (\n      <div className=\"Form-group\">\n        <label>{this.attrs.label}</label>\n\n        {this.attrs.disabled ? (\n          <div className=\"Button Button--danger\">{label}</div>\n        ) : (\n          <Dropdown\n            label={label}\n            disabled={this.attrs.disabled}\n            buttonClassName=\"Button Button--danger\"\n          >\n            {app.store\n              .all(\"groups\")\n              .filter(\n                (g) => ![Group.MEMBER_ID, Group.GUEST_ID].includes(g.id())\n              )\n              .map((g) =>\n                Button.component(\n                  {\n                    active: group && group.id() === g.id(),\n                    disabled: group && group.id() === g.id(),\n                    icon: g.icon(),\n                    onclick: () => {\n                      this.attrs.onchange(g.id());\n                    },\n                  },\n                  g.namePlural()\n                )\n              )}\n          </Dropdown>\n        )}\n      </div>\n    );\n  }\n}\n","import Component from \"flarum/Component\";\nimport Button from \"flarum/components/Button\";\nimport Stream from \"flarum/utils/Stream\";\n\nclass MinMaxSelector extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.state = -1;\n    if (this.attrs.min() !== -1) this.state += 1;\n    if (this.attrs.max() !== -1) this.state += 2;\n\n    this.min = Stream(this.attrs.min());\n    this.max = Stream(this.attrs.max());\n  }\n\n  view() {\n    return (\n      <div className=\"Form-group MinMaxSelector\">\n        <label>{this.attrs.label}</label>\n        <div className=\"MinMaxSelector--inputs\">{this.controls()}</div>\n      </div>\n    );\n  }\n\n  controls() {\n    const minInput = () => (\n      <input\n        className=\"FormControl\"\n        type=\"number\"\n        min=\"0\"\n        max={\n          this.state === MinMaxSelector.State.BETWEEN\n            ? this.attrs.max() !== -1\n              ? this.attrs.max()\n              : this.max()\n            : Infinity\n        }\n        placeholder=\"min\"\n        bidi={this.attrs.min}\n      ></input>\n    );\n\n    const maxInput = () => (\n      <input\n        className=\"FormControl\"\n        type=\"number\"\n        min={\n          this.state ===\n          Math.max(\n            0,\n            MinMaxSelector.State.BETWEEN\n              ? this.attrs.min() !== -1\n                ? this.attrs.min()\n                : this.min()\n              : 0\n          )\n        }\n        placeholder=\"max\"\n        bidi={this.attrs.max}\n      ></input>\n    );\n\n    const placeholder = () => (\n      <input\n        className=\"FormControl MinMaxSelector--placeholder\"\n        disabled\n        placeholder=\"X\"\n      ></input>\n    );\n\n    const button = (icon) => (\n      <Button\n        className=\"Button\"\n        onclick={this.cycle.bind(this)}\n        icon={icon}\n      ></Button>\n    );\n\n    switch (this.state) {\n      case MinMaxSelector.State.LTE:\n        return [placeholder(), button(\"fas fa-less-than-equal\"), maxInput()];\n      case MinMaxSelector.State.GTE:\n        return [placeholder(), button(\"fas fa-greater-than-equal\"), minInput()];\n      case MinMaxSelector.State.BETWEEN:\n        return [\n          minInput(),\n          button(\"fas fa-less-than-equal\"),\n          placeholder(),\n          button(\"fas fa-less-than-equal\"),\n          maxInput(),\n        ];\n    }\n  }\n\n  cycle() {\n    this.state++;\n    this.state %= 3;\n\n    if (this.attrs.min() !== -1) this.min(this.attrs.min());\n    if (this.attrs.max() !== -1) this.max(this.attrs.max());\n\n    switch (this.state) {\n      case MinMaxSelector.State.GTE:\n        this.attrs.min(this.min());\n        this.attrs.max(-1);\n        break;\n      case MinMaxSelector.State.LTE:\n        this.attrs.min(-1);\n        this.attrs.max(this.max());\n        break;\n      case MinMaxSelector.State.BETWEEN:\n        this.attrs.min(this.min());\n        this.attrs.max(this.max());\n        break;\n    }\n  }\n}\n\nMinMaxSelector.State = {\n  GTE: 0,\n  LTE: 1,\n  BETWEEN: 2,\n};\n\nexport default MinMaxSelector;\n","import augmentEditUserModal from \"../common/augmentEditUserModal\";\nimport registerModels from \"../common/registerModels\";\nimport AutoModeratorPage from \"./components/AutoModeratorPage\";\nimport CriterionPage from \"./components/CriterionPage\";\nimport GroupActionDriverSettings from \"./components/GroupActionDriverSettings\";\n\napp.initializers.add(\"askvortsov/flarum-auto-moderator\", () => {\n  app.routes.criterion = { path: '/askvortsov-auto-moderator/criterion/:id', component: CriterionPage };\n\n  app['askvortsov-auto-moderator'] = {\n    actionDriverSettingsComponents: {\n      add_to_group: GroupActionDriverSettings,\n      remove_from_group: GroupActionDriverSettings,\n    }\n  }\n  \n  app.extensionData\n    .for(\"askvortsov-auto-moderator\")\n    .registerPage(AutoModeratorPage);\n\napp.route.criterion = (criterion) => {\n  return app.route('criterion', { id: criterion?.id() || 'new' })\n}\n\naugmentEditUserModal();\nregisterModels();\n});\n","import { extend, override } from \"flarum/common/extend\";\nimport EditUserModal from \"flarum/common/components/EditUserModal\";\nimport GroupBadge from \"flarum/common/components/GroupBadge\";\nimport LoadingIndicator from \"flarum/common/components/LoadingIndicator\";\nimport ItemList from \"flarum/common/utils/ItemList\";\nimport managedGroups from \"./utils/managedGroups\";\n\nexport default function augmentEditUserModal() {\n  extend(EditUserModal.prototype, \"oninit\", function () {\n    this.loading = true;\n    app.store.find(\"criteria\").then((criteria) => {\n      managedGroups(criteria)\n        .forEach((group) => delete this.groups[group.id()]);\n\n      this.loading = false;\n      m.redraw();\n    });\n  });\n\n  override(EditUserModal.prototype, \"fields\", function (original) {\n    if (this.loading) {\n      const items = new ItemList();\n      items.add(\"loading\", <LoadingIndicator></LoadingIndicator>);\n      return items;\n    }\n\n    const items = original();\n\n    items.add(\n      \"Criteria\",\n      <div className=\"Form-group\">\n        <label>\n          {app.translator.trans(\n            \"askvortsov-auto-moderator.forum.edit_user.managed_groups_heading\"\n          )}\n        </label>\n        {managedGroups(app.store.all(\"criteria\")).map((group) => (\n          <label className=\"checkbox\">\n            <input\n              type=\"checkbox\"\n              checked={this.attrs.user.groups().includes(group)}\n              disabled={true}\n            />\n            {app.translator.trans(\n              \"askvortsov-auto-moderator.forum.edit_user.managed_group\",\n              {\n                badge: GroupBadge.component({\n                  group,\n                  label: \"\"\n                }),\n                groupName: Criterion.group().nameSingular(),\n              }\n            )}\n          </label>\n        ))}\n        <p>\n          {app.translator.trans(\n            \"askvortsov-auto-moderator.forum.edit_user.groups_not_editable\"\n          )}\n        </p>\n      </div>,\n      10\n    );\n\n    return items;\n  });\n}\n","import Model from \"flarum/Model\";\n\nexport default class Criterion extends Model {}\n\nObject.assign(Criterion.prototype, {\n  name: Model.attribute(\"name\"),\n  description: Model.attribute(\"description\"),\n  actions: Model.attribute(\"actions\"),\n  metrics: Model.attribute(\"metrics\"),\n  requirements: Model.attribute(\"requirements\"),\n  isValid: Model.attribute(\"isValid\"),\n  invalidActionSettings: Model.attribute(\"invalidActionSettings\")\n});\n","import Model from \"flarum/Model\";\nimport User from \"flarum/models/User\";\nimport Criterion from \"./models/Criterion\";\n\nexport default function registerModels() {\n  app.store.models.criteria = Criterion;\n\n  User.prototype.criteria = Model.hasMany(\"criteria\");\n}\n","export default function managedGroups(criteria) {\n    return criteria\n        .filter((criterion) => {\n            return criterion.actions();\n        })\n        .reduce((acc, criterion) => {\n            const ids = criterion\n                .actions()\n                .filter(a => a.type === 'add_to_group' || a.type === 'remove_from_group')\n                .map(a => a.settings['group_id']);\n            acc.push(...ids);\n        }, [])\n        .map((groupId) => app.store.getById('groups', groupId))\n        .filter(g => g);\n}","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['admin/components/AdminPage'];","module.exports = flarum.core.compat['admin/components/ExtensionPage'];","module.exports = flarum.core.compat['common/components/Alert'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/components/EditUserModal'];","module.exports = flarum.core.compat['common/components/GroupBadge'];","module.exports = flarum.core.compat['common/components/Link'];","module.exports = flarum.core.compat['common/components/LinkButton'];","module.exports = flarum.core.compat['common/components/LoadingIndicator'];","module.exports = flarum.core.compat['common/components/Select'];","module.exports = flarum.core.compat['common/components/Tooltip'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/helpers/icon'];","module.exports = flarum.core.compat['common/utils/ItemList'];","module.exports = flarum.core.compat['common/utils/Stream'];","module.exports = flarum.core.compat['common/utils/classList'];","module.exports = flarum.core.compat['common/utils/stringToColor'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/Dropdown'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['models/Group'];","module.exports = flarum.core.compat['models/User'];","module.exports = flarum.core.compat['utils/Stream'];"],"sourceRoot":""}