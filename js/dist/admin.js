module.exports=function(t){var e={};function a(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=t,a.c=e,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(s,n,function(e){return t[e]}.bind(null,n));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=20)}([function(t,e){t.exports=flarum.core.compat.Model},function(t,e,a){"use strict";function s(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}a.d(e,"a",(function(){return s}))},function(t,e){t.exports=flarum.core.compat["utils/Stream"]},function(t,e){t.exports=flarum.core.compat["components/LoadingIndicator"]},function(t,e){t.exports=flarum.core.compat["components/Button"]},function(t,e){t.exports=flarum.core.compat["models/User"]},function(t,e){t.exports=flarum.core.compat["utils/ItemList"]},function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return c}));var s=a(0),n=a.n(s),r=a(5),o=a.n(r);function i(){return(i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s])}return t}).apply(this,arguments)}var l=a(1),u=function(t){function e(){return t.apply(this,arguments)||this}return Object(l.a)(e,t),e}(n.a);function c(){app.store.models.trust_levels=u,o.a.prototype.trustLevels=n.a.hasMany("trustLevels")}i(u.prototype,{name:n.a.attribute("name"),group:n.a.hasOne("group"),ranges:n.a.attribute("ranges")})},function(t,e){t.exports=flarum.core.compat["helpers/icon"]},function(t,e){t.exports=flarum.core.compat.Component},,,function(t,e){t.exports=flarum.core.compat["models/Group"]},,,function(t,e){t.exports=flarum.core.compat["components/ExtensionPage"]},function(t,e){t.exports=flarum.core.compat["components/Modal"]},function(t,e){t.exports=flarum.core.compat["components/Dropdown"]},,,function(t,e,a){"use strict";a.r(e);var s=a(7),n=a(1),r=a(15),o=a.n(r),i=a(3),l=a.n(i),u=a(8),c=a.n(u),p=a(16),d=a.n(p),f=a(4),v=a.n(f),h=a(6),b=a.n(h),g=a(2),x=a.n(g),_=a(9),y=a.n(_),E=function(t){function e(){return t.apply(this,arguments)||this}Object(n.a)(e,t);var a=e.prototype;return a.oninit=function(a){t.prototype.oninit.call(this,a),this.state=e.State.DISABLED,-1!==this.attrs.min()&&(this.state+=1),-1!==this.attrs.max()&&(this.state+=2),this.min=x()(this.attrs.min()),this.max=x()(this.attrs.max())},a.view=function(){return m("div",{className:"Form-group MinMaxSelector"},m("label",null,this.attrs.label),m("div",{className:"MinMaxSelector--inputs"},this.controls()))},a.controls=function(){var t=this,a=function(){return m("input",{className:"FormControl",type:"number",min:"0",max:t.state===e.State.BETWEEN?-1!==t.attrs.max()?t.attrs.max():t.max():1/0,placeholder:"min",bidi:t.attrs.min})},s=function(){return m("input",{className:"FormControl",type:"number",min:t.state===Math.max(0,e.State.BETWEEN?-1!==t.attrs.min()?t.attrs.min():t.min():0),placeholder:"max",bidi:t.attrs.max})},n=function(){return m("input",{className:"FormControl MinMaxSelector--placeholder",disabled:!0,placeholder:"X"})},r=function(e){return m(v.a,{className:"Button",onclick:t.cycle.bind(t),icon:e})};switch(console.log(this.state),this.state){case e.State.DISABLED:return r("fas fa-power-off");case e.State.LTE:return[n(),r("fas fa-less-than-equal"),a()];case e.State.GTE:return[n(),r("fas fa-greater-than-equal"),s()];case e.State.BETWEEN:return[a(),r("fas fa-less-than-equal"),n(),r("fas fa-less-than-equal"),s()]}},a.cycle=function(){switch(this.state++,this.state%=4,-1!==this.attrs.min()&&this.min(this.attrs.min()),-1!==this.attrs.max()&&this.max(this.attrs.max()),this.state){case 0:this.attrs.min(-1),this.attrs.max(-1);break;case 1:this.attrs.min(this.min()),this.attrs.max(-1);break;case 2:this.attrs.min(-1),this.attrs.max(this.max());break;case 3:this.attrs.min(this.min()),this.attrs.max(this.max())}},a.showMin=function(){return this.state===e.State.LTE||this.state===e.State.BETWEEN},a.showMax=function(){return this.state===e.State.GTE||this.state===e.State.BETWEEN},e}(y.a);E.State={DISABLED:0,LTE:1,GTE:2,BETWEEN:3};var N=E,L=a(17),T=a.n(L),S=a(12),M=a.n(S),k=function(t){function e(){return t.apply(this,arguments)||this}return Object(n.a)(e,t),e.prototype.view=function(){var t=this,e=app.store.getById("groups",this.attrs.id()),a=e?[c()(e.icon()),"\t",e.namePlural()]:app.translator.trans("askvortsov-trust-levels.admin.group_selector.placeholder");return m("div",{className:"Form-group"},m("label",null,this.attrs.label),this.attrs.disabled?m("div",{className:"Button Button--danger"},a):m(T.a,{label:a,disabled:this.attrs.disabled,buttonClassName:"Button Button--danger"},app.store.all("groups").filter((function(t){return![M.a.MEMBER_ID,M.a.GUEST_ID].includes(t.id())})).map((function(a){return v.a.component({active:e&&e.id()===a.id(),disabled:e&&e.id()===a.id(),icon:a.icon(),onclick:function(){t.attrs.id(a.id())}},a.namePlural())}))))},e}(y.a),B=function(t){function e(){return t.apply(this,arguments)||this}Object(n.a)(e,t);var a=e.prototype;return a.oninit=function(e){var a=this;t.prototype.oninit.call(this,e),this.trustLevel=this.attrs.model||app.store.createRecord("trust_levels");var s=this.trustLevel.group();this.groupId=x()(s?s.id():null),this.name=x()(this.trustLevel.name()||""),this.loading=!0,app.request({method:"GET",url:app.forum.attribute("apiUrl")+"/trust_level_drivers"}).then((function(t){a.rangeTranslations=t.data.attributes.drivers,a.ranges=Object.keys(a.rangeTranslations),a.ranges.forEach((function(t){var e=a.trustLevel.ranges()||[],s=e["min"+t],n=e["max"+t];a["min"+t]=x()(s||-1),a["max"+t]=x()(n||-1)})),a.loading=!1,m.redraw()}))},a.className=function(){return"EditTrustLevelModal Modal--small"},a.title=function(){return this.name()?this.name():app.translator.trans("askvortsov-trust-levels.admin.trust_level_modal.title")},a.content=function(){return this.loading?m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"container"},m(l.a,null)))):m("div",{className:"Modal-body"},m("div",{className:"Form"},this.fields().toArray()))},a.fields=function(){var t=this,e=new b.a;return e.add("name",m("div",{className:"Form-group"},m("label",null,app.translator.trans("askvortsov-trust-levels.admin.trust_level_modal.name_label")),m("input",{className:"FormControl",placeholder:app.translator.trans("askvortsov-trust-levels.admin.trust_level_modal.name_placeholder"),bidi:this.name})),50),e.add("group",m("div",{className:"Form-group"},m(k,{label:app.translator.trans("askvortsov-trust-levels.admin.trust_level_modal.group_label"),id:this.groupId,disabled:this.trustLevel.exists})),50),this.ranges.forEach((function(a){e.add(a,m(N,{label:app.translator.trans(t.rangeTranslations[a]),min:t["min"+a],max:t["max"+a]}),40)})),e.add("submit",m("div",{className:"Form-group"},v.a.component({type:"submit",className:"Button Button--primary EditTrustLevelModal-save",loading:this.loading,disabled:0===this.name().length||!this.groupId()},app.translator.trans("askvortsov-trust-levels.admin.trust_level_modal.submit_button")),this.trustLevel.exists?m("button",{type:"button",className:"Button EditTrustLevelModal-delete",onclick:this.delete.bind(this)},app.translator.trans("askvortsov-trust-levels.admin.trust_level_modal.delete_button")):""),-10),e},a.submitData=function(){var t=this,e=app.store.getById("groups",this.groupId()),a={name:this.name(),relationships:{group:e}};return this.ranges.forEach((function(e){a["min"+e]=t["min"+e](),a["max"+e]=t["max"+e]()})),a},a.onsubmit=function(t){var e=this;t.preventDefault(),this.loading=!0,this.trustLevel.save(this.submitData()).then((function(){return e.hide()}),(function(){return e.loading=!1}))},a.delete=function(){confirm(app.translator.trans("askvortsov-trust-levels.admin.trust_level_modal.delete_confirmation"))&&(this.trustLevel.delete().then((function(){m.redraw()})),this.hide())},e}(d.a);function O(t){var e=t?t.name():app.translator.trans("askvortsov-trust-levels.admin.trust_level_page.create_trust_level_button"),a=t?t.group().icon():"fas fa-plus",s=t?{"background-color":t.group().color(),color:"white"}:"";return m("div",{className:"ExtensionListItem",onclick:function(){return app.modal.show(B,{model:t})}},m("span",{className:"ExtensionListItem-icon ExtensionIcon",style:s},c()(a)),m("span",{className:"ExtensionListItem-title"},e))}var j=function(t){function e(){return t.apply(this,arguments)||this}Object(n.a)(e,t);var a=e.prototype;return a.oninit=function(e){var a=this;t.prototype.oninit.call(this,e),this.loading=!0,app.store.find("trust_levels").then((function(){a.loading=!1,m.redraw()}))},a.content=function(){return this.loading?m("div",{className:"TrustLevels"},m("div",{className:"container"},m(l.a,null))):m("div",{className:"TrustLevels"},m("div",{className:"container"},m("div",{className:"ExtensionsWidget-list TrustLevels-list"},m("p",{className:"TrustLevels-list-heading"},app.translator.trans("askvortsov-trust-levels.admin.trust_level_page.list_heading")),m("div",{className:"ExtensionList"},[].concat(app.store.all("trust_levels").map(O),[O()]))),m("div",{className:"TrustLevels-footer"},m("p",null,app.translator.trans("askvortsov-trust-levels.admin.trust_level_page.instructions_header")),m("ul",null,app.translator.trans("askvortsov-trust-levels.admin.trust_level_page.instructions_text")))))},e}(o.a);app.initializers.add("askvortsov/flarum-trust-levels",(function(){app.extensionData.for("askvortsov-trust-levels").registerPage(j),Object(s.default)()}))}]);
//# sourceMappingURL=admin.js.map